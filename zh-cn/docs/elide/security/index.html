<!doctype html>
<html lang="zh-cn" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-elide/security" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.0">
<title data-rh="true">Security | Astraios</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://astraios.io/zh-cn/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://astraios.io/zh-cn/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://astraios.io/zh-cn/docs/elide/security"><meta data-rh="true" property="og:locale" content="zh_cn"><meta data-rh="true" property="og:locale:alternate" content="en"><meta data-rh="true" name="docusaurus_locale" content="zh-cn"><meta data-rh="true" name="docsearch:language" content="zh-cn"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Security | Astraios"><meta data-rh="true" name="description" content="Authorization support"><meta data-rh="true" property="og:description" content="Authorization support"><link data-rh="true" rel="icon" href="/zh-cn/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://astraios.io/zh-cn/docs/elide/security"><link data-rh="true" rel="alternate" href="https://astraios.io/docs/elide/security" hreflang="en"><link data-rh="true" rel="alternate" href="https://astraios.io/zh-cn/docs/elide/security" hreflang="zh-cn"><link data-rh="true" rel="alternate" href="https://astraios.io/docs/elide/security" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://11324Y7IH1-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Astraios" href="/zh-cn/opensearch.xml"><link rel="stylesheet" href="/zh-cn/assets/css/styles.654a6c71.css">
<script src="/zh-cn/assets/js/runtime~main.486ea8ea.js" defer="defer"></script>
<script src="/zh-cn/assets/js/main.c1562dd0.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/zh-cn/"><div class="navbar__logo"><img src="/zh-cn/img/logo.svg" alt="Astraios Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/zh-cn/img/logo.svg" alt="Astraios Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Astraios</b></a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>中文（中国）</a><ul class="dropdown__menu"><li><a href="/docs/elide/security" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">English</a></li><li><a href="/zh-cn/docs/elide/security" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="zh-cn">中文（中国）</a></li></ul></div><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/zh-cn/docs/intro">Documentation</a><a href="https://paion-data.github.io/astraios/apidocs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">API<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/paion-data/astraios" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-icon-link header-github-link"> <svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/zh-cn/docs/intro">快速入门</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/zh-cn/docs/setup">设置</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/zh-cn/docs/development">开发</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/zh-cn/docs/configuration">配置</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/zh-cn/docs/category/elide-library">Elide Library</a><button aria-label="折叠侧边栏分类 &#x27;Elide Library&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-cn/docs/elide/features">Features</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-cn/docs/elide/data-model">Data Models</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/zh-cn/docs/elide/security">Security</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-cn/docs/elide/datastores">Data Stores</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-cn/docs/elide/audit">Logging &amp; Audit</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/zh-cn/docs/category/client-apis">Client APIs</a><button aria-label="展开侧边栏分类 &#x27;Client APIs&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-cn/docs/elide/openapi">OpenAPI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-cn/docs/elide/performance">Performance</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/zh-cn/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/zh-cn/docs/category/elide-library"><span itemprop="name">Elide Library</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Security</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>Security</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="core-concepts">Core Concepts<a href="#core-concepts" class="hash-link" aria-label="Core Concepts的直接链接" title="Core Concepts的直接链接">​</a></h2>
<p>API authentication is largely a solved problem and generally outside the scope of Elide. Authorization - the act of
verifying data and operation access for an <em>already authenticated user</em> in the Elide framework involves a few core
concepts:</p>
<ul>
<li><strong>User</strong> - Each API request is associated with a user principal. The user is opaque to the Elide framework but is
passed to developer-defined <em>check</em> functions that evaluate arbitrary logic or build filter expressions. More details
can be found <a href="#user">here</a>.</li>
<li><strong>Checks</strong> - a function <em>or</em> filter expression that grants or denies a user <strong>permission</strong> to perform a particular
action.</li>
<li><strong>Permissions</strong> - a set of annotations (read, update, delete, create, and transfer) that correspond to actions on
the data model&#x27;s entities and fields. Each <strong>permission</strong> is decorated with one or more checks that are evaluated
when a user attempts to perform that action.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="security-evaluation">Security Evaluation<a href="#security-evaluation" class="hash-link" aria-label="Security Evaluation的直接链接" title="Security Evaluation的直接链接">​</a></h2>
<p>Security is applied hierarchically with three goals:</p>
<ol>
<li><strong>Granting or denying access.</strong> When a model or field is accessed, a set of checks are evaluated to determine if
the access will be denied (i.e. 403 HTTP status code (JSON-API) or GraphQL error object) or permitted. If a user
has explicitly requested access to part of the data model they should not see, the request will be rejected.</li>
<li><strong>Filtering Collections.</strong> If a model has read permissions defined, these checks are evaluated against each model
that is a member of the collection. Only the models the user has access to (by virtue of being able to read at
least one of the model&#x27;s fields) are returned in the response.</li>
<li><strong>Filtering a model.</strong> If a user has read access to a model, but only for a subset of a model&#x27;s fields, the
disallowed fields are excluded from the output (rather than denying the request). However, when the user
explicitly requests a field-set that contains a restricted field, the request is rejected rather than filtered.</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="hierarchical-security">Hierarchical Security<a href="#hierarchical-security" class="hash-link" aria-label="Hierarchical Security的直接链接" title="Hierarchical Security的直接链接">​</a></h3>
<p>Both JSON-API and GraphQL define mechanisms to fetch and manipulate entities defined by the data model schema. Some
(rootable) entities can be reached directly by providing their data type and unique identifier in the query. Other
entities can only be reached through relationships to other entities by traversing the entity relationship graph. The
Elide framework supports both methods of access. This is beneficial because it alleviates the need for all models to be
read-accessible at the root of the graph. When everything is exposed at the root, the developer needs to enumerate all
of the valid access patterns for all of the data models which can be unwieldy. In addition to eliminating redundancy in
security declaration, this form of security can have significant performance benefits for enforcing security on large
collections stored in key-value stores that have limited ability for the underlying persistence layer to directly apply
security filters. It is often possible to deny read access to an entire collection (i.e. hierarchical relationship)
before attempting to verify access to each individual member within that collection. Typically, security rules only need
to be defined for a subset of models and relationships - often near the roots of the graph. Applying security rules to
the relationships to prune the graph can eliminate invalid access patterns. To better understand the sequence of how
security is applied, consider the data model depicted in Figure below consisting of articles where each contains zero or
more comments.</p>
<p><img loading="lazy" alt="Security Article Comment UML" src="data:image/png;base64,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" width="220" height="104" class="img_ev3q"></p>
<p>The request to update a specific comment of a particular article involves the following permission checks:</p>
<ol>
<li>Read permission check on the Article&#x27;s comments field.</li>
<li>Update permission check on the Comment&#x27;s title field.</li>
</ol>
<p>When a client modifies one side of a bidirectional relationship, Elide will automatically update the opposite side of
the relationship. This implies that the client must have permission to write both sides of the relationship.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="checks">Checks<a href="#checks" class="hash-link" aria-label="Checks的直接链接" title="Checks的直接链接">​</a></h2>
<p>Checks are simply functions that either return:</p>
<ul>
<li>whether or not access should be granted to the requesting user.</li>
<li>a filter expression that can be used to filter a collection to what is visible to a given user.</li>
</ul>
<p>Checks can either be invoked:</p>
<ul>
<li>immediately prior to the (create, read, update, and delete) action being performed. This is the default case.</li>
<li>immediately before committing the transaction that wraps the entire API request. This is limited to checks on
fields of newly created objects.</li>
</ul>
<p>Elide supports three different concrete <code>Check</code> classes depending on what is being checked:</p>
<p><img loading="lazy" alt="Error loading check-tree.png" src="/zh-cn/assets/images/check-tree-599e5f0c554a1ff69093dfde84f4110f.png" width="861" height="225" class="img_ev3q"></p>
<p><code>Check</code> is the root interface of all three variants which are discussed next</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="operation-checks">Operation Checks<a href="#operation-checks" class="hash-link" aria-label="Operation Checks的直接链接" title="Operation Checks的直接链接">​</a></h3>
<p>Operation checks are inline checks whose evaluation requires the entity instance being read from or written to. They
operate in memory of the process running Elide.</p>
<p>Operation checks are expected to implement the following <code>Check</code> interface:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * Determines whether the user can access the resource.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @param object The object that is being read/written.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @param requestScope Request scope object</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @param changeSpec Summary of modifications</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @return true if security check passed</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">abstract</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">boolean</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ok</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">T</span><span class="token plain"> object</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">RequestScope</span><span class="token plain"> requestScope</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">Optional</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">ChangeSpec</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> changeSpec</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="user-checks">User Checks<a href="#user-checks" class="hash-link" aria-label="User Checks的直接链接" title="User Checks的直接链接">​</a></h3>
<p>User checks depend strictly on the user principal. They only take a User object as input. Because these checks only
depend on who is performing the operation and not on what has changed, these checks are only evaluated once per
request - an optimization that accelerates the filtering of large collections.</p>
<p>User checks are expected to implement the following <code>Check</code> interface:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * Method reserved for user checks.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @param user User to check</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @return True if user check passes, false otherwise</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">abstract</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">boolean</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ok</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">User</span><span class="token plain"> user</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="filter-expression-checks">Filter Expression Checks<a href="#filter-expression-checks" class="hash-link" aria-label="Filter Expression Checks的直接链接" title="Filter Expression Checks的直接链接">​</a></h3>
<p>In some cases, the check logic can be pushed down to the data store itself. For example, a filter can be added to a
database query to remove elements from a collection where access is disallowed. These checks return a
<code>FilterExpression</code> predicate that your data store can use to limit the queries that it uses to marshal the data.
Checks which extend the <code>FilterExpessionCheck</code> must conform to the interface:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * Returns a FilterExpression from FilterExpressionCheck.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @param entityClass entity type</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @param requestScope Request scope object</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @return FilterExpression for FilterExpressionCheck.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">abstract</span><span class="token plain"> </span><span class="token class-name">FilterExpression</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getFilterExpression</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Type</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics operator" style="color:#393A34">?</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> entityClass</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">RequestScope</span><span class="token plain"> requestScope</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>FilterExpressionCheck</code> <em>is</em> an <code>OperationCheck</code>. If a security rule combines both an <code>OperationCheck</code> and
<code>FilterExpression</code> in a disjunction (logical OR), Elide will evaluate both in memory as operation checks.</p>
<p>Most <code>FilterExpressionCheck</code> functions construct a <code>FilterPredicate</code> which is a concrete implementation of the
<code>FilterExpression</code> interface:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * Constructs a filter predicate.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @param path The path through the entity relationship graph to a particular attribute to filter on.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @param op The filter comparison operator to evaluate.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @param values The list of values to compare the attribute against.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token class-name">FilterPredicate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Path</span><span class="token plain"> path</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">Operator</span><span class="token plain"> op</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">List</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Object</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> values</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Here is an example to filter the Author model by book titles:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Construct a filter for the Author model for books.title == &#x27;Harry Potter&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">Path</span><span class="token class-name punctuation" style="color:#393A34">.</span><span class="token class-name">PathElement</span><span class="token plain"> authorPath </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Path</span><span class="token class-name punctuation" style="color:#393A34">.</span><span class="token class-name">PathElement</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Author</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">class</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">Book</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">class</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;books&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">Path</span><span class="token class-name punctuation" style="color:#393A34">.</span><span class="token class-name">PathElement</span><span class="token plain"> bookPath </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Path</span><span class="token class-name punctuation" style="color:#393A34">.</span><span class="token class-name">PathElement</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Book</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">class</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">String</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">class</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;title&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">List</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Path</span><span class="token generics class-name punctuation" style="color:#393A34">.</span><span class="token generics class-name">PathElement</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> pathList </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">Arrays</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">asList</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">authorPath</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> bookPath</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">Path</span><span class="token plain"> path </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Path</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pathList</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">FilterPredicate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">path</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">Operator</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">IN</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">Collections</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">singletonList</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Harry Potter&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Filter expression checks are most important when a security rule is tied in some way to the data itself. By pushing
the security rule down to the datastore, the data can be more efficiently queried which vastly improves performance.
Moreover, this feature is critical for implementing a service that requires complex security rules (i.e. anything
more than role-based access) on large collections.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="user">User<a href="#user" class="hash-link" aria-label="User的直接链接" title="User的直接链接">​</a></h2>
<p>Each request is associated with a <code>User</code> object. The User is simply an object that wraps a
<code>java.security.Principal</code> object. It includes methods to:</p>
<ol>
<li>Extract the user name.</li>
<li>Extract the underlying principal.</li>
<li>Check if the user belongs to a particular role.</li>
</ol>
<p>The <code>User</code> objects wraps the Jakarta
<a href="https://qubitpi.github.io/jakartaee-rest/jaxrs-api/target/apidocs/jakarta.ws.rs/jakarta/ws/rs/core/SecurityContext.html" target="_blank" rel="noopener noreferrer">SecurityContext</a>
-object.</p>
<p>The <code>SecurityContext</code> is created outside the Elide framework in a <a href="https://jcp.org/en/jsr/detail?id=311" target="_blank" rel="noopener noreferrer">JAX-RS</a>
<a href="https://qubitpi.github.io/jakartaee-rest/jaxrs-api/target/apidocs/jakarta.ws.rs/jakarta/ws/rs/container/ContainerRequestFilter.html" target="_blank" rel="noopener noreferrer">ContainerRequestFilter</a>:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token annotation punctuation" style="color:#393A34">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">filter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">ContainerRequestContext</span><span class="token plain"> containerRequestContext</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">throws</span><span class="token plain"> </span><span class="token class-name">IOException</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    containerRequestContext</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setSecurityContext</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">SecurityContext</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This filter will typically authenticate the request and store an identifier about the user inside the new
<code>SecurityContext</code>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="permission-annotations">Permission Annotations<a href="#permission-annotations" class="hash-link" aria-label="Permission Annotations的直接链接" title="Permission Annotations的直接链接">​</a></h2>
<p>The permission annotations include <code>ReadPermission</code>, <code>UpdatePermission</code>, <code>CreatePermission</code>, and <code>DeletePermission</code>
Permissions are annotations which can be applied to a model at the <code>package</code>, <code>entity</code>, or <code>field</code>-level. The most
specific annotation always take precedence (<code>package &lt; entity &lt; field</code>). More specifically, a field annotation
overrides the behavior of an entity annotation. An entity annotation overrides the behavior of a package annotation.
Entity annotations can be inherited from superclasses. When no annotation is provided at any level, access is
implicitly granted for <code>ReadPermission</code>, <code>UpdatePermission</code>, <code>CreatePermission</code>, and <code>DeletePermission</code>.</p>
<p>The permission annotations wrap a boolean expression composed of the check(s) to be evaluated combined with <code>AND</code>,
<code>OR</code>, and <code>NOT</code> operators and grouped using parenthesis. The checks are uniquely identified within the expression by
a string - typically a human readable phrase that describes the intent of the check (<em>&quot;principal is admin at company
OR principal is super user with write permissions&quot;</em>). These strings are mapped to the explicit <code>Check</code> classes at
runtime by registering them with Elide. When no registration is made, the checks can be identified by their fully
qualified class names. The complete expression grammar can be found [here][source-grammar].</p>
<p>To better understand how permissions work consider the following sample code. (Only the relevant portions are
included.)</p>
<div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">User.java</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Post.java</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Comment.java</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">IsOwner.java</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">IsSuperuser.java</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token annotation punctuation" style="color:#393A34">@ReadPermission</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">expression </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Prefab.Role.All&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token annotation punctuation" style="color:#393A34">@UpdatePermission</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">expression </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;user is a superuser OR user is this user&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token annotation punctuation" style="color:#393A34">@DeletePermission</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">expression </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;user is a superuser OR user is this user&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">User</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">String</span><span class="token plain"> name</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#393A34">@OneToMany</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mappedBy </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;author&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">Set</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Post</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> posts</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token annotation punctuation" style="color:#393A34">@ReadPermission</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">expression </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Post.isVisible OR user owns this post OR user is a superuser&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token annotation punctuation" style="color:#393A34">@UpdatePermission</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">expression </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;user owns this post&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token annotation punctuation" style="color:#393A34">@CreatePermission</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">expression </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;user owns this post&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token annotation punctuation" style="color:#393A34">@DeletePermission</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">expression </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;user owns this post&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">Post</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#393A34">@ManyToOne</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">User</span><span class="token plain"> author</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#393A34">@UpdatePermission</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">expression </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;user owns this post OR user is a superuser&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">boolean</span><span class="token plain"> published</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#393A34">@OneToMany</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mappedBy </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;post&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">Set</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Comment</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> comments</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// user has to be able to see the post and to see the comment, or else be a super user</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token annotation punctuation" style="color:#393A34">@ReadPermission</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">expression </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;((Post.isVisible OR user owns this post) AND (comment is visible OR user made this comment)) OR user is a superuser&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token annotation punctuation" style="color:#393A34">@UpdatePermission</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">expression </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;user made this comment&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token annotation punctuation" style="color:#393A34">@CreatePermission</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">expression </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;post is visible&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token annotation punctuation" style="color:#393A34">@DeletePermission</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">expression </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;user made this comment&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">Comment</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#393A34">@ManyToOne</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">User</span><span class="token plain"> author</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#393A34">@ManyToOne</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">Post</span><span class="token plain"> post</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#393A34">@UpdatePermission</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">expression </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;user owns this post OR user is a superuser&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">boolean</span><span class="token plain"> suppressed</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token annotation punctuation" style="color:#393A34">@SecurityCheck</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">IsOwner</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">PRINCIPAL_IS_OWNER</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">IsOwner</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Post</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">OperationCheck</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">final</span><span class="token plain"> </span><span class="token class-name">String</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">PRINCIPAL_IS_OWNER</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;user owns this post&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#393A34">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">boolean</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ok</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Post</span><span class="token plain"> post</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">RequestScope</span><span class="token plain"> requestScope</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">Optional</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">ChangeSpec</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> changeSpec</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> post</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">author</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">equals</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">requestScope</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getUser</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token annotation punctuation" style="color:#393A34">@SecurityCheck</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">IsSuperUser</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">PRINCIPAL_IS_SUPERUSER</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">IsSuperuser</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">UserCheck</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">final</span><span class="token plain"> </span><span class="token class-name">String</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">PRINCIPAL_IS_SUPERUSER</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;user is a superuser&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#393A34">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">boolean</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ok</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">User</span><span class="token plain"> user</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> user</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">isInRole</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;SUPER_USER&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="read">Read<a href="#read" class="hash-link" aria-label="Read的直接链接" title="Read的直接链接">​</a></h3>
<p><code>ReadPermission</code> governs whether a model or field can be read by a particular user. If the expression evaluates to
<code>true</code> then access is granted. Notably, <code>ReadPermission</code> is evaluated as the user navigates through the entity
relationship graph. Elide&#x27;s security model is focused on field-level access, with permission annotations applied on an
entity or package being shorthand for applying that same security to every field in that scope. For example, if a
request is made to <code>GET /users/1/posts/3/comments/99</code> the permission execution will be as follows:</p>
<ol>
<li><code>ReadPermission</code> on <code>User&lt;1&gt;#posts</code></li>
<li><code>ReadPermission</code> on <code>Post&lt;3&gt;#comments</code></li>
<li><code>ReadPermission</code> on any field on <code>Comment&lt;99&gt;</code></li>
</ol>
<p>If all of these checks succeed, then the response will succeed. The contents of the response are determined by
evaluating the <code>ReadPermission</code> on each field. The response will contain the subset of fields where <code>ReadPermission</code> is
granted. If a field does not have an annotation, then access defaults to whatever is specified at the entity level. If
the entity does not have an annotation, access defaults to whatever is specified at the package. If the package does not
have an annotation, access defaults to granted.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="update">Update<a href="#update" class="hash-link" aria-label="Update的直接链接" title="Update的直接链接">​</a></h3>
<p><code>UpdatePermission</code> governs whether a model can be updated by a particular user. Update is invoked when an attribute&#x27;s
value is changed or values are added to or removed from a relationship. Examples of operations that will evaluate
<code>UpdatePermission</code> given objects <code>Post</code> and <code>User</code> from the code snippets above:</p>
<ul>
<li>Changing the value of <code>Post.published</code> will evaluate <code>UpdatePermission</code> on <code>published</code>. Because more specific checks
override less specific checks, the <code>UpdatePermission</code> on the entity <code>Post</code> will not be evaluated.</li>
<li>Setting <code>Post.author = User</code> will evaluate <code>UpdatePermission</code> on <code>Post</code> since <code>author</code> does not have a more specific
annotation. Because <code>author</code> is a bidirectional relationship, <code>UpdatePermission</code> will also be evaluated on the
<code>User.posts</code> field.</li>
<li>Removing <code>Post</code> from <code>User.posts</code> will trigger <code>UpdatePermission</code> on both the <code>Post</code> and <code>User</code> entities.</li>
<li>Creating <code>Post</code> will <em>not</em> trigger <code>UpdatePermission</code> checks on any fields that are initialized in the request.
However, it will trigger <code>UpdatePermission</code> on any bidirectional relationship fields on preexisting objects.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="create">Create<a href="#create" class="hash-link" aria-label="Create的直接链接" title="Create的直接链接">​</a></h3>
<p><code>CreatePermission</code> governs whether a model can be created or a field can be initialized in a newly created model
instance. Whenever a model instance is newly created, initialized fields are evaluated against <code>CreatePermission</code> rather
than <code>UpdatePermission</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="delete">Delete<a href="#delete" class="hash-link" aria-label="Delete的直接链接" title="Delete的直接链接">​</a></h3>
<p><code>DeletePermission</code> governs whether a model can be deleted.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="nontransferable">NonTransferable<a href="#nontransferable" class="hash-link" aria-label="NonTransferable的直接链接" title="NonTransferable的直接链接">​</a></h3>
<p><code>NonTransferable</code> governs whether an existing model instance (one created in a prior transaction) can be assigned to
another collection other than the one in which it was initially created. Basically, does a collection &#x27;own&#x27; the model
instance in a private sense (composition) or can it be moved or referenced by other collections (aggregation).</p>
<p>Marking an object <code>NonTransferable</code> means that it is owned by its containing collections at object creation. It cannot
be moved or copied to another collection after creation. Excluding this annotation means that instances of the class can
be moved or copied to other collections <em>provided the user agent can read the object</em> (<code>ReadPermission</code> is satisfied on
at least some of its fields).</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="registering-checks-in-elide">Registering Checks in Elide<a href="#registering-checks-in-elide" class="hash-link" aria-label="Registering Checks in Elide的直接链接" title="Registering Checks in Elide的直接链接">​</a></h2>
<p>Once an Elide data model has been annotated with Permission annotations, the textual descriptions of the checks must be
tied to actual check classes and registered in Elide. This can be done in one of two ways:</p>
<ol>
<li>Automatically by marking the <code>Check</code> classes with a <code>SecurityCheck</code> annotation. Elide will automatically scan for
<code>SecurityCheck</code> classes and bind them.</li>
<li>Manually by creating a <code>Map&lt;String, Class&lt;? extends Check&gt;&gt;</code> where they key is the description and the value is the
Check class. This is then passed to the constructor of the <code>EntityDictionary</code>.</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="automatic-scanning">Automatic Scanning<a href="#automatic-scanning" class="hash-link" aria-label="Automatic Scanning的直接链接" title="Automatic Scanning的直接链接">​</a></h3>
<p>Elide will find our security checks in the classpath if they are tagged with the <code>SecurityCheck</code> annotation:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token annotation punctuation" style="color:#393A34">@SecurityCheck</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">AdminCheck</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">USER_IS_ADMIN</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">AdminCheck</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">UserCheck</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">final</span><span class="token plain"> </span><span class="token class-name">String</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">USER_IS_ADMIN</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;User is Admin&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#393A34">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">boolean</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ok</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">User</span><span class="token plain"> user</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The <code>EntityDictionary</code> must be told to scan for checks (by calling <code>dictionary.scanForSecurityChecks</code>). This is done
automatically in Elide at startup.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/paion-data/astraios/tree/master/docs/docs/elide/security.mdx" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/zh-cn/docs/elide/data-model"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">Data Models</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/zh-cn/docs/elide/datastores"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">Data Stores</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#core-concepts" class="table-of-contents__link toc-highlight">Core Concepts</a></li><li><a href="#security-evaluation" class="table-of-contents__link toc-highlight">Security Evaluation</a><ul><li><a href="#hierarchical-security" class="table-of-contents__link toc-highlight">Hierarchical Security</a></li></ul></li><li><a href="#checks" class="table-of-contents__link toc-highlight">Checks</a><ul><li><a href="#operation-checks" class="table-of-contents__link toc-highlight">Operation Checks</a></li><li><a href="#user-checks" class="table-of-contents__link toc-highlight">User Checks</a></li><li><a href="#filter-expression-checks" class="table-of-contents__link toc-highlight">Filter Expression Checks</a></li></ul></li><li><a href="#user" class="table-of-contents__link toc-highlight">User</a></li><li><a href="#permission-annotations" class="table-of-contents__link toc-highlight">Permission Annotations</a><ul><li><a href="#read" class="table-of-contents__link toc-highlight">Read</a></li><li><a href="#update" class="table-of-contents__link toc-highlight">Update</a></li><li><a href="#create" class="table-of-contents__link toc-highlight">Create</a></li><li><a href="#delete" class="table-of-contents__link toc-highlight">Delete</a></li><li><a href="#nontransferable" class="table-of-contents__link toc-highlight">NonTransferable</a></li></ul></li><li><a href="#registering-checks-in-elide" class="table-of-contents__link toc-highlight">Registering Checks in Elide</a><ul><li><a href="#automatic-scanning" class="table-of-contents__link toc-highlight">Automatic Scanning</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/zh-cn/docs/intro">Documentation</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/paion-data/astraios/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discussions<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/paion-data/astraios" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Paion Data. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>